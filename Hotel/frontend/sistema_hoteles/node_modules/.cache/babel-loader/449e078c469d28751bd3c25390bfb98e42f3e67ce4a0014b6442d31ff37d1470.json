{"ast":null,"code":"var _jsxFileName = \"/home/pmorales/Downloads/Proyecto-B2B/Hotel/frontend/sistema_hoteles/src/components/Analiticos.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { Container, Row, Col, Form, Button, Table, Pagination, InputGroup, FormControl } from 'react-bootstrap';\nimport { Chart as ChartJS, CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend, PointElement, LineElement, ArcElement } from 'chart.js';\nimport { Bar, Line, Pie } from 'react-chartjs-2';\nimport axios from 'axios';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport emailjs from 'emailjs-com';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nChartJS.register(CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend, PointElement, LineElement, ArcElement);\nconst Analiticos = () => {\n  _s();\n  const [barChartData, setBarChartData] = useState({});\n  const [lineChartData, setLineChartData] = useState({});\n  const [pieChartData, setPieChartData] = useState({});\n\n  // paginacion\n\n  const [currentPage, setCurrentPage] = useState(1);\n  const [recordsPerPage] = useState(25);\n  const [searchResults, setSearchResults] = useState([]);\n  const [filters, setFilters] = useState({\n    fechaDesde: '',\n    fechaHasta: '',\n    tipoAcceso: '',\n    esAutenticado: ''\n  });\n  const [email, setEmail] = useState(''); // correo\n\n  useEffect(() => {\n    const fetchGraphData = async () => {\n      await fetchBusquedasPorPais();\n      await fetchEvolucionBusquedas();\n      await fetchTipoAcceso();\n    };\n    fetchGraphData();\n  }, []); // Assuming no dependencies\n\n  const fetchBusquedasPorPais = async () => {\n    const response = await axios.get('http://localhost:8080/analiticos/registros/paises');\n    const paises = response.data;\n    const labels = Object.keys(paises);\n    const data = labels.map(pais => paises[pais]);\n    setBarChartData({\n      labels,\n      datasets: [{\n        label: 'Número de búsquedas por país',\n        data,\n        backgroundColor: 'rgba(255, 99, 132, 0.5)'\n      }]\n    });\n  };\n  const fetchEvolucionBusquedas = async () => {\n    const response = await axios.get('http://localhost:8080/analiticos/registros/evolucion');\n    const evolucion = response.data;\n    const labels = Object.keys(evolucion);\n    const data = labels.map(fecha => evolucion[fecha]);\n    setLineChartData({\n      labels,\n      datasets: [{\n        label: 'Búsquedas a lo largo del tiempo',\n        data,\n        fill: false,\n        borderColor: 'rgb(75, 192, 192)',\n        tension: 0.1\n      }]\n    });\n  };\n  const fetchTipoAcceso = async () => {\n    const response = await axios.get('http://localhost:8080/analiticos/registros/tipoacceso');\n    const tipoAcceso = response.data;\n    const labels = Object.keys(tipoAcceso);\n    const data = labels.map(type => tipoAcceso[type]);\n    setPieChartData({\n      labels,\n      datasets: [{\n        label: 'Distribución del Tipo de Acceso',\n        data,\n        backgroundColor: ['rgba(255, 205, 86, 0.7)', 'rgba(54, 162, 235, 0.7)'],\n        hoverOffset: 4\n      }]\n    });\n  };\n  const handleFilterChange = e => {\n    const {\n      name,\n      value,\n      type,\n      checked\n    } = e.target;\n    // Use the checkbox value if it's the 'esAutenticado' filter\n    setFilters({\n      ...filters,\n      [name]: type === 'checkbox' ? checked : value\n    });\n  };\n  const handleSearch = async () => {\n    const esAutenticadoValue = filters.esAutenticado ? 'true' : 'false';\n    const offset = new Date().getTimezoneOffset() * 60000;\n    const formattedFromDate = filters.fechaDesde ? new Date(new Date(filters.fechaDesde).getTime() - offset).toISOString() : '';\n    const formattedToDate = filters.fechaHasta ? new Date(new Date(filters.fechaHasta).getTime() - offset).toISOString() : '';\n    console.log(`Searching from ${formattedFromDate} to ${formattedToDate}`);\n    const params = new URLSearchParams({\n      fechaDesde: formattedFromDate,\n      fechaHasta: formattedToDate,\n      tipoAcceso: filters.tipoAcceso\n    });\n\n    // Add the esAutenticado parameter conditionally based on the checkbox\n    if (filters.esAutenticado !== '') {\n      params.append('esAutenticado', esAutenticadoValue);\n    }\n    try {\n      const response = await axios.get(`http://localhost:8080/analiticos/filtrar?${params}`);\n      const formattedResults = response.data.map(item => ({\n        ...item,\n        fechaHora: new Date(item.fechaHora).toLocaleString('en-US', {\n          year: 'numeric',\n          month: 'numeric',\n          day: 'numeric',\n          hour: '2-digit',\n          minute: '2-digit',\n          second: '2-digit',\n          hour12: true\n        })\n      }));\n      setSearchResults(formattedResults);\n      setCurrentPage(1);\n    } catch (error) {\n      console.error('Error fetching search results:', error);\n      setSearchResults([]);\n    }\n  };\n\n  // PAGINEO\n  const indexOfLastRecord = currentPage * recordsPerPage;\n  const indexOfFirstRecord = indexOfLastRecord - recordsPerPage;\n  const currentRecords = searchResults.slice(indexOfFirstRecord, indexOfLastRecord);\n  const paginate = pageNumber => setCurrentPage(pageNumber);\n\n  // CORREO\n  const [file, setFile] = useState(null);\n  const convertToCSV = data => {\n    const replacer = (key, value) => value === null ? '' : value;\n    const header = Object.keys(data[0]);\n    let csv = data.map(row => header.map(fieldName => JSON.stringify(row[fieldName], replacer)).join(','));\n    csv.unshift(header.join(','));\n    csv = csv.join('\\r\\n');\n    console.log(\"Generated CSV:\", csv);\n    return csv;\n  };\n  const downloadCSV = csvData => {\n    const blob = new Blob([csvData], {\n      type: 'text/csv;charset=utf-8;'\n    });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.setAttribute('hidden', '');\n    a.setAttribute('href', url);\n    a.setAttribute('download', 'download.csv');\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n  };\n  const handleDownload = () => {\n    const csvData = convertToCSV(currentRecords);\n    downloadCSV(csvData);\n  };\n  const sendEmail = () => {\n    if (!file) {\n      console.error(\"No file selected\");\n      return;\n    }\n    const reader = new FileReader();\n    reader.onload = event => {\n      const base64data = event.target.result.split(',')[1];\n      const templateParams = {\n        to_email: email,\n        attachment: base64data\n      };\n      emailjs.send('service_db-dw2', 'template_rq1e8jw', templateParams, '83TAqc_7hHgnfdESC').then(response => {\n        console.log('Email successfully sent!', response.status, response.text);\n      }, error => {\n        console.error('Failed to send email:', error);\n      });\n    };\n    reader.readAsDataURL(file);\n  };\n  const handleFileChange = event => {\n    setFile(event.target.files[0]);\n  };\n  const handleExport = () => {\n    const csvData = convertToCSV(currentRecords);\n    sendEmail(csvData);\n  };\n  return /*#__PURE__*/_jsxDEV(Container, {\n    fluid: true,\n    className: \"analiticos-container\",\n    children: [/*#__PURE__*/_jsxDEV(Row, {\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        md: 12,\n        children: [/*#__PURE__*/_jsxDEV(Form, {\n          children: /*#__PURE__*/_jsxDEV(Row, {\n            children: [/*#__PURE__*/_jsxDEV(Col, {\n              md: 3,\n              children: /*#__PURE__*/_jsxDEV(Form.Group, {\n                controlId: \"fechaDesde\",\n                children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                  children: \"Fecha Desde\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 229,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                  type: \"datetime-local\",\n                  name: \"fechaDesde\",\n                  value: filters.fechaDesde,\n                  onChange: handleFilterChange\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 230,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 228,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 227,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              md: 3,\n              children: /*#__PURE__*/_jsxDEV(Form.Group, {\n                controlId: \"fechaHasta\",\n                children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                  children: \"Fecha Hasta\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 235,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                  type: \"datetime-local\",\n                  name: \"fechaHasta\",\n                  value: filters.fechaHasta,\n                  onChange: handleFilterChange\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 236,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              md: 3,\n              children: /*#__PURE__*/_jsxDEV(Form.Group, {\n                controlId: \"tipoAcceso\",\n                children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                  children: \"Tipo de Acceso\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 241,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                  as: \"select\",\n                  name: \"tipoAcceso\",\n                  value: filters.tipoAcceso,\n                  onChange: handleFilterChange,\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"\",\n                    children: \"Seleccione\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 243,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"web\",\n                    children: \"Web\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 244,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"REST\",\n                    children: \"REST\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 245,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 242,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 240,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              md: 3,\n              children: /*#__PURE__*/_jsxDEV(Form.Group, {\n                controlId: \"esAutenticado\",\n                children: /*#__PURE__*/_jsxDEV(Form.Check, {\n                  type: \"checkbox\",\n                  label: \"Authenticated\",\n                  name: \"esAutenticado\",\n                  checked: filters.esAutenticado,\n                  onChange: handleFilterChange\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 251,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 250,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              md: 3,\n              className: \"d-flex align-items-end\",\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                onClick: handleSearch,\n                children: \"Buscar\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 261,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Table, {\n          striped: true,\n          bordered: true,\n          hover: true,\n          size: \"sm\",\n          className: \"mt-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"#\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Usuario ID\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 269,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Fecha/Hora\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 270,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Detalle de B\\xFAsqueda\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 271,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Tipo Acceso\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 272,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 267,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 266,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: currentRecords.map((item, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: item.id\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 278,\n                columnNumber: 13\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: item.usuarioId || 'No Autenticado'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 279,\n                columnNumber: 13\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: item.fechaHora\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 280,\n                columnNumber: 13\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: item.parametrosBusqueda\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 281,\n                columnNumber: 13\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: item.tipoAcceso\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 282,\n                columnNumber: 13\n              }, this)]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 9\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Pagination, {\n          children: Array.from({\n            length: Math.ceil(searchResults.length / recordsPerPage)\n          }, (_, i) => /*#__PURE__*/_jsxDEV(Pagination.Item, {\n            active: i + 1 === currentPage,\n            onClick: () => paginate(i + 1),\n            children: i + 1\n          }, i + 1, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 25\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        md: 12,\n        children: /*#__PURE__*/_jsxDEV(InputGroup, {\n          className: \"mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(FormControl, {\n            placeholder: \"Recipient's email\",\n            \"aria-label\": \"Recipient's email\",\n            value: email,\n            onChange: e => setEmail(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n            type: \"file\",\n            onChange: handleFileChange,\n            accept: \".csv\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 313,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"outline-secondary\",\n            onClick: sendEmail,\n            children: \"Send Email\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 318,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        md: 12,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"chart-title\",\n          children: \"An\\xE1lisis de B\\xFAsquedas por Pa\\xEDs\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 21\n        }, this), barChartData.labels && /*#__PURE__*/_jsxDEV(Bar, {\n          data: barChartData,\n          options: {\n            responsive: true\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 45\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        md: 12,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"chart-title\",\n          children: \"Evoluci\\xF3n de las B\\xFAsquedas\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 21\n        }, this), lineChartData.labels && /*#__PURE__*/_jsxDEV(Line, {\n          data: lineChartData,\n          options: {\n            responsive: true,\n            scales: {\n              y: {\n                beginAtZero: true\n              }\n            }\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 46\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        md: 12,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"chart-title\",\n          children: \"Distribuci\\xF3n del Tipo de Acceso\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 21\n        }, this), pieChartData.labels && /*#__PURE__*/_jsxDEV(Pie, {\n          data: pieChartData,\n          options: {\n            responsive: true\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 45\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 222,\n    columnNumber: 9\n  }, this);\n};\n_s(Analiticos, \"PomNkQQpAZ4vjfg7GIgERIdw7RY=\");\n_c = Analiticos;\nexport default Analiticos;\nvar _c;\n$RefreshReg$(_c, \"Analiticos\");","map":{"version":3,"names":["React","useState","useEffect","Container","Row","Col","Form","Button","Table","Pagination","InputGroup","FormControl","Chart","ChartJS","CategoryScale","LinearScale","BarElement","Title","Tooltip","Legend","PointElement","LineElement","ArcElement","Bar","Line","Pie","axios","emailjs","jsxDEV","_jsxDEV","register","Analiticos","_s","barChartData","setBarChartData","lineChartData","setLineChartData","pieChartData","setPieChartData","currentPage","setCurrentPage","recordsPerPage","searchResults","setSearchResults","filters","setFilters","fechaDesde","fechaHasta","tipoAcceso","esAutenticado","email","setEmail","fetchGraphData","fetchBusquedasPorPais","fetchEvolucionBusquedas","fetchTipoAcceso","response","get","paises","data","labels","Object","keys","map","pais","datasets","label","backgroundColor","evolucion","fecha","fill","borderColor","tension","type","hoverOffset","handleFilterChange","e","name","value","checked","target","handleSearch","esAutenticadoValue","offset","Date","getTimezoneOffset","formattedFromDate","getTime","toISOString","formattedToDate","console","log","params","URLSearchParams","append","formattedResults","item","fechaHora","toLocaleString","year","month","day","hour","minute","second","hour12","error","indexOfLastRecord","indexOfFirstRecord","currentRecords","slice","paginate","pageNumber","file","setFile","convertToCSV","replacer","key","header","csv","row","fieldName","JSON","stringify","join","unshift","downloadCSV","csvData","blob","Blob","url","window","URL","createObjectURL","a","document","createElement","setAttribute","body","appendChild","click","removeChild","handleDownload","sendEmail","reader","FileReader","onload","event","base64data","result","split","templateParams","to_email","attachment","send","then","status","text","readAsDataURL","handleFileChange","files","handleExport","fluid","className","children","md","Group","controlId","Label","fileName","_jsxFileName","lineNumber","columnNumber","Control","onChange","as","Check","onClick","striped","bordered","hover","size","index","id","usuarioId","parametrosBusqueda","Array","from","length","Math","ceil","_","i","Item","active","placeholder","accept","variant","options","responsive","scales","y","beginAtZero","_c","$RefreshReg$"],"sources":["/home/pmorales/Downloads/Proyecto-B2B/Hotel/frontend/sistema_hoteles/src/components/Analiticos.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Container, Row, Col, Form, Button, Table, Pagination, InputGroup, FormControl } from 'react-bootstrap';\nimport { Chart as ChartJS, CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend, PointElement, LineElement, ArcElement } from 'chart.js';\nimport { Bar, Line, Pie } from 'react-chartjs-2';\nimport axios from 'axios';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport emailjs from 'emailjs-com';\n\n\nChartJS.register(\n  CategoryScale,\n  LinearScale,\n  BarElement,\n  Title,\n  Tooltip,\n  Legend,\n  PointElement,\n  LineElement,\n  ArcElement\n);\n\nconst Analiticos = () => {\n    const [barChartData, setBarChartData] = useState({});\n    const [lineChartData, setLineChartData] = useState({});\n    const [pieChartData, setPieChartData] = useState({});\n\n    // paginacion\n\n    const [currentPage, setCurrentPage] = useState(1);\n    const [recordsPerPage] = useState(25);\n\n\n    const [searchResults, setSearchResults] = useState([]);\n    const [filters, setFilters] = useState({ fechaDesde: '', fechaHasta: '', tipoAcceso: '', esAutenticado: '' });\n\n    const [email, setEmail] = useState(''); // correo\n\n\n    useEffect(() => {\n        const fetchGraphData = async () => {\n            await fetchBusquedasPorPais();\n            await fetchEvolucionBusquedas();\n            await fetchTipoAcceso();\n        };\n    \n        fetchGraphData();\n    }, []); // Assuming no dependencies\n    \n\n    const fetchBusquedasPorPais = async () => {\n        const response = await axios.get('http://localhost:8080/analiticos/registros/paises');\n        const paises = response.data;\n        const labels = Object.keys(paises);\n        const data = labels.map(pais => paises[pais]);\n        setBarChartData({\n            labels,\n            datasets: [{\n                label: 'Número de búsquedas por país',\n                data,\n                backgroundColor: 'rgba(255, 99, 132, 0.5)',\n            }],\n        });\n    };\n\n    const fetchEvolucionBusquedas = async () => {\n        const response = await axios.get('http://localhost:8080/analiticos/registros/evolucion');\n        const evolucion = response.data;\n        const labels = Object.keys(evolucion);\n        const data = labels.map(fecha => evolucion[fecha]);\n        setLineChartData({\n            labels,\n            datasets: [{\n                label: 'Búsquedas a lo largo del tiempo',\n                data,\n                fill: false,\n                borderColor: 'rgb(75, 192, 192)',\n                tension: 0.1,\n            }],\n        });\n    };\n\n    const fetchTipoAcceso = async () => {\n        const response = await axios.get('http://localhost:8080/analiticos/registros/tipoacceso');\n        const tipoAcceso = response.data;\n        const labels = Object.keys(tipoAcceso);\n        const data = labels.map(type => tipoAcceso[type]);\n        setPieChartData({\n            labels,\n            datasets: [{\n                label: 'Distribución del Tipo de Acceso',\n                data,\n                backgroundColor: ['rgba(255, 205, 86, 0.7)', 'rgba(54, 162, 235, 0.7)'],\n                hoverOffset: 4\n            }],\n        });\n    };\n\n    const handleFilterChange = e => {\n        const { name, value, type, checked } = e.target;\n        // Use the checkbox value if it's the 'esAutenticado' filter\n        setFilters({ ...filters, [name]: type === 'checkbox' ? checked : value });\n    };\n\n    const handleSearch = async () => {\n        const esAutenticadoValue = filters.esAutenticado ? 'true' : 'false'; \n\n        const offset = new Date().getTimezoneOffset() * 60000;\n        const formattedFromDate = filters.fechaDesde ? (new Date(new Date(filters.fechaDesde).getTime() - offset)).toISOString() : '';\n        const formattedToDate = filters.fechaHasta ? (new Date(new Date(filters.fechaHasta).getTime() - offset)).toISOString() : '';\n    \n        console.log(`Searching from ${formattedFromDate} to ${formattedToDate}`);\n        const params = new URLSearchParams({\n            fechaDesde: formattedFromDate,\n            fechaHasta: formattedToDate,\n            tipoAcceso: filters.tipoAcceso,\n        });\n    \n        // Add the esAutenticado parameter conditionally based on the checkbox\n        if (filters.esAutenticado !== '') {\n            params.append('esAutenticado', esAutenticadoValue);\n        }\n    \n        try {\n            const response = await axios.get(`http://localhost:8080/analiticos/filtrar?${params}`);\n            const formattedResults = response.data.map(item => ({\n                ...item,\n                fechaHora: new Date(item.fechaHora).toLocaleString('en-US', {\n                    year: 'numeric', month: 'numeric', day: 'numeric',\n                    hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true\n                })\n            }));\n            setSearchResults(formattedResults);\n            setCurrentPage(1);\n        } catch (error) {\n            console.error('Error fetching search results:', error);\n            setSearchResults([]);\n        }\n    };\n    \n\n    // PAGINEO\n    const indexOfLastRecord = currentPage * recordsPerPage;\n    const indexOfFirstRecord = indexOfLastRecord - recordsPerPage;\n    const currentRecords = searchResults.slice(indexOfFirstRecord, indexOfLastRecord);\n    \n    const paginate = (pageNumber) => setCurrentPage(pageNumber);\n    \n\n\n\n// CORREO\nconst [file, setFile] = useState(null);\n\n\n\nconst convertToCSV = (data) => {\n    const replacer = (key, value) => value === null ? '' : value;\n    const header = Object.keys(data[0]);\n    let csv = data.map(row => header.map(fieldName => \n        JSON.stringify(row[fieldName], replacer)).join(','));\n    csv.unshift(header.join(','));\n    csv = csv.join('\\r\\n');\n    console.log(\"Generated CSV:\", csv);\n    return csv;\n};\n\nconst downloadCSV = (csvData) => {\n    const blob = new Blob([csvData], { type: 'text/csv;charset=utf-8;' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.setAttribute('hidden', '');\n    a.setAttribute('href', url);\n    a.setAttribute('download', 'download.csv');\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n};\n\nconst handleDownload = () => {\n    const csvData = convertToCSV(currentRecords);\n    downloadCSV(csvData);\n};\n\nconst sendEmail = () => {\n    if (!file) {\n        console.error(\"No file selected\");\n        return;\n    }\n\n    const reader = new FileReader();\n    reader.onload = (event) => {\n        const base64data = event.target.result.split(',')[1];\n        const templateParams = {\n            to_email: email,\n            attachment: base64data,\n        };\n\n        emailjs.send('service_db-dw2', 'template_rq1e8jw', templateParams, '83TAqc_7hHgnfdESC')\n            .then((response) => {\n                console.log('Email successfully sent!', response.status, response.text);\n            }, (error) => {\n                console.error('Failed to send email:', error);\n            });\n    };\n    reader.readAsDataURL(file);\n};\n\n\n\nconst handleFileChange = (event) => {\n    setFile(event.target.files[0]);\n};\n\n\nconst handleExport = () => {\n    const csvData = convertToCSV(currentRecords);\n    sendEmail(csvData);\n};\n\n   \n    return (\n        <Container fluid className=\"analiticos-container\">\n            <Row>\n                <Col md={12}>\n                    <Form>\n                        <Row>\n                            <Col md={3}>\n                                <Form.Group controlId=\"fechaDesde\">\n                                    <Form.Label>Fecha Desde</Form.Label>\n                                    <Form.Control type=\"datetime-local\" name=\"fechaDesde\" value={filters.fechaDesde} onChange={handleFilterChange} />\n                                </Form.Group>\n                            </Col>\n                            <Col md={3}>\n                                <Form.Group controlId=\"fechaHasta\">\n                                    <Form.Label>Fecha Hasta</Form.Label>\n                                    <Form.Control type=\"datetime-local\" name=\"fechaHasta\" value={filters.fechaHasta} onChange={handleFilterChange} />\n                                </Form.Group>\n                            </Col>\n                            <Col md={3}>\n                                <Form.Group controlId=\"tipoAcceso\">\n                                    <Form.Label>Tipo de Acceso</Form.Label>\n                                    <Form.Control as=\"select\" name=\"tipoAcceso\" value={filters.tipoAcceso} onChange={handleFilterChange}>\n                                        <option value=\"\">Seleccione</option>\n                                        <option value=\"web\">Web</option>\n                                        <option value=\"REST\">REST</option\n                                    ></Form.Control>\n                                </Form.Group>\n                            </Col>\n                            <Col md={3}>\n                                <Form.Group controlId=\"esAutenticado\">\n                                    <Form.Check\n                                        type=\"checkbox\"\n                                        label=\"Authenticated\"\n                                        name=\"esAutenticado\"\n                                        checked={filters.esAutenticado}\n                                        onChange={handleFilterChange}\n                                    />\n                                </Form.Group>\n                            </Col>\n                            <Col md={3} className=\"d-flex align-items-end\">\n                                <Button onClick={handleSearch}>Buscar</Button>\n                            </Col>\n                        </Row>\n                    </Form>\n                    <Table striped bordered hover size=\"sm\" className=\"mt-4\">\n                        <thead>\n                            <tr>\n                                <th>#</th>\n                                <th>Usuario ID</th>\n                                <th>Fecha/Hora</th>\n                                <th>Detalle de Búsqueda</th>\n                                <th>Tipo Acceso</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n    {currentRecords.map((item, index) => (\n        <tr key={index}>\n            <td>{item.id}</td>\n            <td>{item.usuarioId || 'No Autenticado'}</td>\n            <td>{item.fechaHora}</td>\n            <td>{item.parametrosBusqueda}</td>\n            <td>{item.tipoAcceso}</td>\n        </tr>\n    ))}\n</tbody>\n\n                    </Table>\n                    \n\n\n                    <Pagination>{Array.from({ length: Math.ceil(searchResults.length / recordsPerPage) }, (_, i) => (\n                        <Pagination.Item key={i + 1} active={i + 1 === currentPage} onClick={() => paginate(i + 1)}>\n                            {i + 1}\n                        </Pagination.Item>\n                    ))}</Pagination>\n\n\n\n\n                </Col>\n            </Row>\n\n\n            <Row>\n                <Col md={12}>\n                    <InputGroup className=\"mb-3\">\n                        <FormControl\n                            placeholder=\"Recipient's email\"\n                            aria-label=\"Recipient's email\"\n                            value={email}\n                            onChange={(e) => setEmail(e.target.value)}\n                        />\n                        <FormControl\n                            type=\"file\"\n                            onChange={handleFileChange}\n                            accept=\".csv\"\n                        />\n                        <Button variant=\"outline-secondary\" onClick={sendEmail}>Send Email</Button>\n                    </InputGroup>\n                </Col>\n            </Row>\n\n\n\n\n\n\n            <Row>\n                <Col md={12}>\n                    <h2 className=\"chart-title\">Análisis de Búsquedas por País</h2>\n                    {barChartData.labels && <Bar data={barChartData} options={{ responsive: true }} />}\n                </Col>\n            </Row>\n            <Row>\n                <Col md={12}>\n                    <h2 className=\"chart-title\">Evolución de las Búsquedas</h2>\n                    {lineChartData.labels && <Line data={lineChartData} options={{ responsive: true, scales: { y: { beginAtZero: true } } }} />}\n                </Col>\n            </Row>\n            <Row>\n                <Col md={12}>\n                    <h2 className=\"chart-title\">Distribución del Tipo de Acceso</h2>\n                    {pieChartData.labels && <Pie data={pieChartData} options={{ responsive: true }} />}\n                </Col>\n            </Row>\n\n\n\n\n\n            \n        </Container>\n    ); \n};\n\nexport default Analiticos;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}